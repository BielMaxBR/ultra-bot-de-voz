<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game</title>

    <style>
        body {
            background-color: #0067b9;
        }

        .loading {
            position: absolute;
            width: 100%;
            height: 100%;
            background-color: #0067b9;
            margin: 0px;
            left: 0px;
            top: 0px;
        }

        #screen {
            display: none;
        }
    </style>
</head>

<body>
    <canvas id="screen"></canvas>
    <div class="loading"><a>carregando...</a></div>

    <script src="/assets/index.js"></script>
    <script>
        const myWasm = '/assets/index.wasm';
        const myPck = '/assets/index.pck';

        const engine = new Engine();
        Promise.all([
            // Load and init the engine
            engine.init(myWasm),
            // And the pck concurrently
            engine.preloadFile(myPck),
        ]).then(() => {
            // Now start the engine.
            var canvas = document.getElementById("screen")
            var loadingScreen = document.querySelector(".loading")

            return engine.start({
                args: ['--main-pack', myPck],
                onProgress: (current, total) => {
                    console.log(`${current} de ${total}`)
                    if (current == total) {
                        loadingScreen.style.display = "none"
                        canvas.style.display = "block"
                    }
                },
                canvas
            });
        }).then(() => {
            console.log('Engine has started!');
        });



        engine.startGame({});

    </script>
</body>

</html>
